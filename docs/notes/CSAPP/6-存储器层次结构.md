---
title: csapp-6-存储器层次结构
date: 2023-09-12 22:17:49
tags:
  - CSAPP

---

# Chapter 6 存储器层次结构

## RAM（随机访问存储器）

- SRAM：快但贵；作为高速缓存
- DRAM：作为主存
  - 分时复用地址线；减少引脚数量，增加访问时间
  - 首先将一整行复制到一个内部行缓冲区；接着再从行缓冲区中复制出一个单元

## 非易失性存储器

- 主要是 ROM，但是 ROM 中有的类型实际上既可以读也可以写

![](C:\Users\我\Desktop\MyblogImg\csapp\bus.png)

## 固态硬盘

- Solid State Disk (SSD)，是基于闪存的存储技术
  - 闪存芯片替代传统旋转磁盘中的机械驱动器
  - 闪存翻译层是一个硬件/固件设备，将对逻辑块的请求翻译成对底层物理设备的访问
  - SSD以页为读写单位
  - 将擦除平均分布到所有的块上

![](C:\Users\我\Desktop\MyblogImg\csapp\SSD.png)

- 随机写很慢的原因
  - 擦除块需要相对较长的时间
  - 如果需要修改数据，需要把所有带有用数据的页复制到一个新的块上后；重新进行读写

## 存储器存储结构

![](C:\Users\我\Desktop\MyblogImg\csapp\storage_structure.png)

### cache

- 在CPU寄存器和主存中插入了一个小的SRAM高速缓存存储器，称为L1 cache；4 clock
- 在L1 cache和 main memory中插入L2 cache，10 clock
- 在L2 cache和L3 cache中插入L3 cache，50 clock

![](C:\Users\我\Desktop\MyblogImg\csapp\cache_structure.png)

- 使用中间的位来索引；如果用高位来索引，相邻的块基本会被映射到同一个cache行，cache命中大大减少

![](C:\Users\我\Desktop\MyblogImg\csapp\cache_index.png)

#### core中的cache

![](C:\Users\我\Desktop\MyblogImg\csapp\core_cache.png)

## 编写高速缓存友好的代码

- 让最常见的情况运行得快
- 尽量减少每个循环内部的缓存不命中数量