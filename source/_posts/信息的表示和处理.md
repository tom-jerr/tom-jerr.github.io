---
title: CSAPP--datalab
index_img: /img/cmu.png
categories:
- OS
tags:
- labs
- C&C++
- linux
comment: valine
math: true


---

# 前言

本文是对CSAPP中datalab的实现
<!-- more -->

# 信息的表示和处理

## 1. 补码与无符号数转换

`T`为补码；`U`为无符号整数。

### 1.1 补码转换为无符号数

$$
T2U_{w}=\begin{cases}
x+2^{w},\hspace{5mm}&x<0\\
x,&x\geq0
\end{cases}
$$

### 1.2 无符号数转换为补码

$$
U2T_{w}=\begin{cases}
x,\hspace{5mm}&x\leq TMax_{w}\\
x-2^{w},&x>TMax_{w}
\end{cases}
$$

**C语言中如果无符号数与有符号数进行运算或比较时，会隐式地将有符号数转换为无符号数进行比较。**

***

## 2. 无符号数与补码的截断

无符号数截断：$x^{*}=x \hspace{1mm}mod\hspace{1mm}2^{k} $

补码截断就是先转为无符号截断后，再将其转为补码：$U2T_{k}(x \hspace{1mm}mod\hspace{1mm}2^{k})$

**在计算机中，如果出现了负数，实际上会被转换成一个很大的无符号数，在数组寻址中十分危险。**

***

## 3. 整数运算

### 3.1 无符号数加法

检测无符号加法的溢出：s = x + y；如果 s < x或者等价地 s < y时，结果溢出 

### 3.2 补码的非

$$
-x_{w}^{t} = \begin{cases}TMin_{w},\hspace{3mm}&x=TMin_{w}\\
-x,&x>TMin_{w}\end{cases}
$$

**补码非的位级表示**

1. C语言中，计算 -x 与计算 ~x+1得到结果相同

2. 对从低位到高位第一个1前面的所有位取反



### 3.3 补码乘法

检验乘法正确性可以用除法；检验加法正确性不能用减法（因为（x + y）- x 始终等于 y，不能用作检验）

**malloc调用（有溢出风险）**

![](C:\Users\我\Pictures\图片\malloc_exit.png)

### 3.4 补码除法

需要加上一个偏置值

![](C:\Users\我\Pictures\图片\补码除法.png)

**计算 x/16（int类型为32位）**

~~~C
#include <bits/stdc++.h>
int div16(int x){
	int bias = (a >> 31) & 0xF;
	return (x + bias) >> 4;
}
~~~

***

## 4. 浮点数

浮点数表示正无穷、负无穷、0

![](C:\Users\我\Pictures\图片\浮点数.png)







